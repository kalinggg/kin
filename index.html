<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¥­å ±åƒ¹å–®ç³»çµ±</title>
    <link rel="stylesheet" href="style.css">
    <!-- SheetJS (XLSX) åº« -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>å°ˆæ¥­å ±åƒ¹å–®ç³»çµ±</h1>
        
        <div class="header-info">
            <div>
                <div class="info-group">
                    <label for="quotation-number">å ±åƒ¹å–®ç·¨è™Ÿ</label>
                    <input type="text" id="quotation-number" readonly>
                </div>
                <div class="info-group">
                    <label for="date">æ—¥æœŸ</label>
                    <input type="date" id="date">
                </div>
            </div>
            <div>
                <div class="info-group">
                    <label for="customer">å®¢æˆ¶åç¨±</label>
                    <input type="text" id="customer" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åç¨±">
                </div>
                <div class="info-group">
                    <label for="contact-person">è¯çµ¡äºº</label>
                    <input type="text" id="contact-person" placeholder="è«‹è¼¸å…¥è¯çµ¡äººå§“å">
                </div>
            </div>
        </div>
        
        <table class="items-table">
            <thead>
                <tr>
                    <th width="5%">åºè™Ÿ</th>
                    <th width="35%">é …ç›®æè¿°</th>
                    <th width="10%">æ•¸é‡</th>
                    <th width="15%">å–®åƒ¹</th>
                    <th width="15%">é‡‘é¡</th>
                    <th width="15%">å‚™è¨»</th>
                    <th width="5%">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody id="items-body"></tbody>
        </table>
        
        <div class="button-group">
            <button class="btn-add" id="add-item">ï¼‹ æ–°å¢é …ç›®</button>
            <button class="btn-remove" id="remove-item">ï¼ åˆªé™¤é¸ä¸­é …ç›®</button>
        </div>
        
        <div class="total-section">
            <div>ç¸½è¨ˆ: <span id="grand-total">0</span></div>
        </div>
        
        <div class="info-group">
            <label for="address">åœ°å€</label>
            <textarea id="address" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åœ°å€"></textarea>
        </div>
        
        <div class="info-group">
            <label for="notes">å‚™è¨»èªªæ˜</label>
            <textarea id="notes" placeholder="è«‹è¼¸å…¥ä»»ä½•é¡å¤–çš„èªªæ˜æˆ–æ¢æ¬¾..."></textarea>
        </div>
        
        <div class="export-buttons">
            <button class="btn-export" id="save-btn">ğŸ’¾ å„²å­˜</button>
            <button class="btn-export" id="delete-btn">ğŸ—‘ï¸ åˆªé™¤è¨‚å–®</button>
            <button class="btn-export" id="export-txt">ğŸ“„ å°å‡ºTXT</button>
            <button class="btn-export" id="export-excel">ğŸ“Š å°å‡ºExcel</button>
            <button class="btn-export" id="print-btn">ğŸ–¨ï¸ åˆ—å°å ±åƒ¹å–®</button>
        </div>
        
        <div class="database-list">
            <h2>æ­·å²å ±åƒ¹å–®</h2>
            <div class="quotation-list" id="quotation-list"></div>
        </div>
    </div>
    <!-- åœ¨HTMLä¸­æ·»åŠ åŠ è¼‰ç‹€æ…‹å’ŒéŒ¯èª¤é¡¯ç¤º -->
<div id="loading" style="display: none;">
  <div class="loading-spinner"></div>
  <p>è³‡æ–™åŠ è¼‰ä¸­...</p>
</div>

<div id="error-message" class="error-alert" style="display: none;"></div>

<style>
.loading-spinner {
  border: 5px solid #f3f3f3;
  border-top: 5px solid #3498db;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 2s linear infinite;
  margin: 0 auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-alert {
  background-color: #f8d7da;
  color: #721c24;
  padding: 15px;
  margin: 15px 0;
  border: 1px solid #f5c6cb;
  border-radius: 4px;
}
</style>
    <script src="script.js"></script>
</body>
</html>
